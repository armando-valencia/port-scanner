<!DOCTYPE html>
<html lang="en">
	<head>
		<meta charset="UTF-8" />
		<meta name="viewport" content="width=device-width, initial-scale=1.0" />
		<title>Port Scanner</title>
		<script src="https://unpkg.com/htmx.org@1.9.10"></script>
		<link rel="stylesheet" href="/styles.css" />
	</head>
	<body>
		<!-- Sidebar -->
		<nav class="sidebar">
			<div class="logo">
				<h2>Port Scanner</h2>
			</div>
			<ul class="nav-menu">
				<li class="nav-item">
					<a
						href="#"
						class="nav-link active"
						onclick="showPage('scanner')"
					>
						Scanner
					</a>
				</li>
				<li class="nav-item">
					<a
						href="#"
						class="nav-link"
						onclick="showPage('how-it-works')"
					>
						How It Works
					</a>
				</li>
			</ul>
		</nav>

		<!-- Main Content -->
		<main class="main-content">
			<!-- Scanner Page -->
			<div id="scanner" class="page active">
				<div class="page-header">
					<h1 class="page-title">Port Scanner</h1>
					<p class="page-subtitle">
						Fast concurrent TCP/UDP port scanning with service
						fingerprinting
					</p>
				</div>

				<div class="scanner-card">
					<form
						class="scan-form"
						hx-post="/api/scan"
						hx-target="#scan-output"
						hx-swap="innerHTML"
					>
						<div class="form-group">
							<label for="target">Target Host</label>
							<input
								type="text"
								id="target"
								name="target"
								value="127.0.0.1"
								required
							/>
						</div>

						<div class="form-group">
							<label for="start_port">Start Port</label>
							<input
								type="number"
								id="start_port"
								name="start_port"
								value="1"
								min="1"
								max="65535"
								required
							/>
						</div>

						<div class="form-group">
							<label for="end_port">End Port</label>
							<input
								type="number"
								id="end_port"
								name="end_port"
								value="1024"
								min="1"
								max="65535"
								required
							/>
						</div>

						<div class="form-group">
							<label for="threads">Threads</label>
							<input
								type="number"
								id="threads"
								name="threads"
								value="10"
								min="1"
								max="100"
								required
							/>
						</div>

						<div class="form-group">
							<label for="timeout_ms">TCP Timeout (ms)</label>
							<input
								type="number"
								id="timeout_ms"
								name="timeout_ms"
								value="50"
								min="10"
								max="5000"
								required
							/>
						</div>

						<div class="form-group">
							<label for="udp_timeout_ms">UDP Timeout (ms)</label>
							<input
								type="number"
								id="udp_timeout_ms"
								name="udp_timeout_ms"
								value="100"
								min="10"
								max="5000"
								required
							/>
						</div>

						<div class="button-group">
							<button type="submit">Start Scan</button>
						</div>
					</form>
				</div>

				<div id="scan-output"></div>
			</div>

			<!-- How It Works Page -->
			<div id="how-it-works" class="page">
				<div class="page-header">
					<h1 class="page-title">How It Works</h1>
					<p class="page-subtitle">
						Understanding the port scanning process
					</p>
				</div>

				<div class="info-section">
					<h3>What is Port Scanning?</h3>
					<p>
						Port scanning is a technique used to find open network
						ports on a computer or server. Each open port can
						represent a service, like a website, application or
						remote login. This tool scans any specified ports to
						determine what kind of service is running.
					</p>
				</div>

				<div class="info-section">
					<h3>Scanning Process</h3>
					<ul class="info-list">
						<li>
							<strong>Connection Attempts:</strong> The scanner
							attempts to establish TCP connections to each port
							in your specified range
						</li>
						<li>
							<strong>Parallel Execution:</strong> Multiple worker
							threads scan ports simultaneously for faster results
						</li>
						<li>
							<strong>Service Detection:</strong> When a port is
							open, the scanner probes it to identify the running
							service
						</li>
						<li>
							<strong>Fingerprinting:</strong> Analyzes banners,
							headers, and protocol responses to determine service
							type and version
						</li>
					</ul>
				</div>

				<div class="info-section">
					<h3>Service Fingerprinting</h3>
					<p>
						The scanner uses multiple detection methods to identify
						services:
					</p>
					<ul class="info-list">
						<li>Banner grabbing for SSH, FTP, SMTP, POP3, IMAP</li>
						<li>
							HTTP Server header analysis with version extraction
						</li>
						<li>TLS/HTTPS detection and certificate inspection</li>
						<li>Protocol-specific probing for various services</li>
						<li>
							Signature database with 30+ web servers and dev
							tools
						</li>
					</ul>
				</div>

				<div class="info-section">
					<h3>Configuration Options</h3>
					<ul class="info-list">
						<li>
							<strong>Target Host:</strong> IP address or hostname
							to scan
						</li>
						<li>
							<strong>Port Range:</strong> Start and end ports
							(1-65535)
						</li>
						<li>
							<strong>Threads:</strong> Number of concurrent
							scanning threads (higher = faster, but more resource
							intensive)
						</li>
						<li>
							<strong>TCP Timeout:</strong> How long to wait for
							TCP connection (lower = faster, but may miss slow
							services)
						</li>
						<li>
							<strong>UDP Timeout:</strong> How long to wait for
							UDP response
						</li>
					</ul>
				</div>

				<div class="info-section">
					<h3>CLI Usage</h3>
					<p>You can also run the scanner from the command line:</p>
					<div class="code-block">
						cargo run -- -d 127.0.0.1 -s 1 -e 1000 -t 20
					</div>
					<p>This scans localhost ports 1-1000 using 20 threads.</p>
				</div>

				<div class="info-section">
					<h3>Understanding Results</h3>
					<ul class="info-list">
						<li>
							<strong>Port:</strong> The port number that was
							found open
						</li>
						<li><strong>Protocol:</strong> TCP or UDP</li>
						<li>
							<strong>Service:</strong> Identified service name
							(e.g., SSH, HTTP, nginx)
						</li>
						<li>
							<strong>Version:</strong> Service version if
							detected
						</li>
						<li>
							<strong>Banner:</strong> Raw response from the
							service
						</li>
						<li>
							<strong>Confidence:</strong> How certain the
							detection is (High: 80%+, Medium: 50-80%, Low: <50%)
						</li>
					</ul>
				</div>
			</div>
		</main>

		<script>
			function showPage(pageId) {
				// Hide all pages
				document.querySelectorAll(".page").forEach((page) => {
					page.classList.remove("active");
				});

				// Remove active from all nav links
				document.querySelectorAll(".nav-link").forEach((link) => {
					link.classList.remove("active");
				});

				// Show selected page
				document.getElementById(pageId).classList.add("active");

				// Add active to clicked nav link
				event.target.closest(".nav-link").classList.add("active");
			}
		</script>
	</body>
</html>
